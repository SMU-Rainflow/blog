### 
- Author: ihuangch
- Date: 2018-11-08
- Email: huangch96@qq.com
###

___

### 背景
公司需要一台巴西地区的vpn，由于之前使用haproxy进行代理，haproxy代理也相对安全一些，但是由于验证
文件无法及时更新，导致代理服务器总是出现滥用的情况。这时想到了ssh也可以做端口转发，就尝试使用了
一下。顺便也学习一下ssh隧道的相关知识。  

### 什么是SSH隧道?
隧道是把一种网络协议封装进另外一种网络协议进行传输的技术。这里我们讨论的是ssh隧道，所以所有的网络
通信协议都是加密的。ssh隧道，又被称为端口转发，因为ssh隧道通常会绑定一个本地端口，所有发向这个端口
的数据包，都会被加密并透明地传输到远端系统。  

ssh隧道可以用于通过ssh加密传输在网络上传输一些没有加密的流量。例如，ftp协议自身是没有加密的，我们
可以使用ssh隧道在ftp服务器和客户端之间安全的传输文件。ssh隧道还提供了绕过防火墙的一些方法，并且
加密自己的流量。  

### SSH隧道的类型?
ssh隧道有3种类型:

	1. 动态端口转发(SOCKS代理)
	2. 本地端口转发
	3. 远程端口转发

###### 端口转发:
Port Forwarding，有时被叫做隧道，是ssh为网络安全通信使用的一种方法。端口转发是转发一个网络端口从
一个网络节点到另一个网络节点的行为，其使一个外部用户从外部经过一个被激活的路由器到达一个在私有
内部ip地址上的一个端口。  
----摘自百度百科  

同时ssh正向隧道、ssh反向隧道、ssh多级隧道，又分别对应哪种端口转发？？？  
接下来会一一分析。  

### 动态端口转发:
动态端口转发允许配置一个本地端口，以便将数据通过隧道传输到所有远程主机。但是，要利用这个功能，连接
到这个端口的客户端应用程序应该使用SOCKS协议发送流量。客户端创建SOCKS代理，并且应用程序（如浏览器）
使用socks协议来指定当流量离开ssh隧道的另一端时应该传输的地址。  


###### 动态端口转发网络拓扑图:
<div align="center"> <img src=""/> </div><br>



